import"./bootstrap.min-f122c4cb.js";import"./header-cf4ee72a.js";const g=document.querySelector("#signUpName"),U=document.querySelector("#signUpAddress"),f=document.querySelector("#signUpEmail"),w=document.querySelector("#signUpPassword"),y=document.querySelector(".signUpBtn"),t=document.querySelector(".signUpForm"),E=document.querySelector(".signUpNameContent"),S=document.querySelector(".signUpAddressContent"),v=document.querySelector(".signUpEmailContent"),C=document.querySelector(".signUpPasswordContent"),l=document.querySelector("#loginEmail"),u=document.querySelector("#loginPassword"),h=document.querySelector(".loginBtn"),d="https://dealmealserver.onrender.com",s=Swal.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:1e3,timerProgressBar:!1,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}});function q(){let e=crypto.randomUUID();axios.post(`${d}/users`,{id:e,name:g.value,address:U.value,email:f.value,password:w.value,cartExist:!1,usedCoupon:[],historyOrder:[]}).then(function(n){s.fire({icon:"success",title:"註冊成功"}).then(c=>{window.location.href="login.html"})}).catch(function(n){console.log(n)})}y.addEventListener("click",function(e){e.preventDefault();const n={用戶名稱:{presence:{allowEmpty:!1,message:"是必填欄位"},format:{pattern:/^[^\s]+([^\s]+)*$/,message:"不可含有空白符號"}}},c={配送地址:{presence:{allowEmpty:!1,message:"是必填欄位"}}},m={電子信箱:{presence:{allowEmpty:!1,message:"是必填欄位"}}},p={密碼:{presence:{allowEmpty:!1,message:"是必填欄位"}}},o=validate(t,n),r=validate(t,c),i=validate(t,m),a=validate(t,p);E.textContent=o?`${o.用戶名稱}`:"",S.textContent=r?`${r.配送地址}`:"",v.textContent=i?`${i.電子信箱}`:"",C.textContent=a?`${a.密碼}`:"",o||r||i||a||q()});function x(){axios.post(`${d}/login`,{email:l.value,password:u.value}).then(function(e){s.fire({icon:"success",title:"登入成功"}).then(n=>{localStorage.setItem("userToken",e.data.accessToken),localStorage.setItem("userId",e.data.user.id),window.location.href="index.html"})}).catch(function(e){console.log(e),s.fire({icon:"error",title:"登入失敗"})})}h.addEventListener("click",function(e){if(e.preventDefault(),!(l.value&&u.value)){s.fire({icon:"warning",title:"欄位未填"});return}x()});

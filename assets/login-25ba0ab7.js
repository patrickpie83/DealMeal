import"./bootstrap.min-d005857b.js";import"./header-6e941449.js";const g=document.querySelector("#signUpName"),U=document.querySelector("#signUpAddress"),f=document.querySelector("#signUpEmail"),w=document.querySelector("#signUpPassword"),y=document.querySelector(".signUpBtn"),n=document.querySelector(".signUpForm"),E=document.querySelector(".signUpNameContent"),S=document.querySelector(".signUpAddressContent"),v=document.querySelector(".signUpEmailContent"),C=document.querySelector(".signUpPasswordContent"),l=document.querySelector("#loginEmail"),m=document.querySelector("#loginPassword"),h=document.querySelector(".loginBtn"),u="https://dealmealserver.onrender.com",s=Swal.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:1e3,timerProgressBar:!1,didOpen:e=>{e.onmouseenter=Swal.stopTimer,e.onmouseleave=Swal.resumeTimer}});function q(){let e=crypto.randomUUID();axios.post(`${u}/users`,{id:e,name:g.value,address:U.value,email:f.value,password:w.value,cartExist:!1,historyOrder:[]}).then(function(t){s.fire({icon:"success",title:"註冊成功"}).then(c=>{window.location.href="login.html"})}).catch(function(t){console.log(t)})}y.addEventListener("click",function(e){e.preventDefault();const t={用戶名稱:{presence:{allowEmpty:!1,message:"是必填欄位"},format:{pattern:/^[^\s]+([^\s]+)*$/,message:"不可含有空白符號"}}},c={配送地址:{presence:{allowEmpty:!1,message:"是必填欄位"}}},d={電子信箱:{presence:{allowEmpty:!1,message:"是必填欄位"}}},p={密碼:{presence:{allowEmpty:!1,message:"是必填欄位"}}},o=validate(n,t),r=validate(n,c),i=validate(n,d),a=validate(n,p);E.textContent=o?`${o.用戶名稱}`:"",S.textContent=r?`${r.配送地址}`:"",v.textContent=i?`${i.電子信箱}`:"",C.textContent=a?`${a.密碼}`:"",o||r||i||a||q()});function x(){axios.post(`${u}/login`,{email:l.value,password:m.value}).then(function(e){s.fire({icon:"success",title:"登入成功"}).then(t=>{localStorage.setItem("userToken",e.data.accessToken),localStorage.setItem("userId",e.data.user.id),window.location.href="index.html"})}).catch(function(e){console.log(e),s.fire({icon:"error",title:"登入失敗"})})}h.addEventListener("click",function(e){if(e.preventDefault(),!(l.value&&m.value)){s.fire({icon:"warning",title:"欄位未填"});return}x()});
